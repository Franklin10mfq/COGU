
import numpy as np
import math

def f_SCVx(hx, hu, dyn_par):
    return np.array([[hx[3,0]],[hx[4,0]],[hx[5,0]],[hu[0,0]],[hu[1,0]],[hu[2,0]],[-0.5*hx[7,0]*hx[10,0] - 0.5*hx[8,0]*hx[11,0] - 0.5*hx[9,0]*hx[12,0]],[0.5*hx[6,0]*hx[10,0] + 0.5*hx[8,0]*hx[12,0] - 0.5*hx[9,0]*hx[11,0]],[0.5*hx[6,0]*hx[11,0] - 0.5*hx[7,0]*hx[12,0] + 0.5*hx[9,0]*hx[10,0]],[0.5*hx[6,0]*hx[12,0] + 0.5*hx[7,0]*hx[11,0] - 0.5*hx[8,0]*hx[10,0]],[(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(hu[5,0] - hx[10,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0]) + hx[11,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(hu[4,0] + hx[10,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - hx[12,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) - (dyn_par[1]*dyn_par[2] - dyn_par[5]**2)*(hu[3,0] - hx[11,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + hx[12,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0])))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(hu[5,0] - hx[10,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0]) + hx[11,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(hu[4,0] + hx[10,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - hx[12,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(hu[3,0] - hx[11,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + hx[12,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0])))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(hu[5,0] - hx[10,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0]) + hx[11,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(hu[4,0] + hx[10,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - hx[12,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(hu[3,0] - hx[11,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + hx[12,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0])))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])]])

def g_SCVx(hx, hu, dyn_par):
    return np.array([[dyn_par[15] - math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2)],[dyn_par[16] - math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2)],[dyn_par[17] - math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2)]])

def A_no_discrete_no_scaled_SCVx(hx, hu, dyn_par):
    return np.array([[0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,-0.5*hx[10,0],-0.5*hx[11,0],-0.5*hx[12,0],-0.5*hx[7,0],-0.5*hx[8,0],-0.5*hx[9,0]],[0,0,0,0,0,0,0.5*hx[10,0],0,0.5*hx[12,0],-0.5*hx[11,0],0.5*hx[6,0],-0.5*hx[9,0],0.5*hx[8,0]],[0,0,0,0,0,0,0.5*hx[11,0],-0.5*hx[12,0],0,0.5*hx[10,0],0.5*hx[9,0],0.5*hx[6,0],-0.5*hx[7,0]],[0,0,0,0,0,0,0.5*hx[12,0],0.5*hx[11,0],-0.5*hx[10,0],0,-0.5*hx[8,0],0.5*hx[7,0],0.5*hx[6,0]],[0,0,0,0,0,0,0,0,0,0,(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[0]*hx[11,0] - 2*dyn_par[3]*hx[10,0] - dyn_par[1]*hx[11,0] - dyn_par[5]*hx[12,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[0]*hx[12,0] + 2*dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - (dyn_par[3]*hx[12,0] - dyn_par[4]*hx[11,0])*(dyn_par[1]*dyn_par[2] - dyn_par[5]**2))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[0]*hx[10,0] + 2*dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0] - dyn_par[1]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[3]*hx[12,0] + dyn_par[5]*hx[10,0]) - (dyn_par[1]*dyn_par[2] - dyn_par[5]**2)*(-dyn_par[4]*hx[10,0] + dyn_par[1]*hx[12,0] - 2*dyn_par[5]*hx[11,0] - dyn_par[2]*hx[12,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[4]*hx[11,0] - dyn_par[5]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[0]*hx[10,0] - dyn_par[3]*hx[11,0] - 2*dyn_par[4]*hx[12,0] + dyn_par[2]*hx[10,0]) - (dyn_par[1]*dyn_par[2] - dyn_par[5]**2)*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + 2*dyn_par[5]*hx[12,0] - dyn_par[2]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[0,0,0,0,0,0,0,0,0,0,((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(dyn_par[0]*hx[11,0] - 2*dyn_par[3]*hx[10,0] - dyn_par[1]*hx[11,0] - dyn_par[5]*hx[12,0]) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(-dyn_par[0]*hx[12,0] + 2*dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(dyn_par[3]*hx[12,0] - dyn_par[4]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(dyn_par[0]*hx[10,0] + 2*dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0] - dyn_par[1]*hx[10,0]) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(-dyn_par[3]*hx[12,0] + dyn_par[5]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[4]*hx[10,0] + dyn_par[1]*hx[12,0] - 2*dyn_par[5]*hx[11,0] - dyn_par[2]*hx[12,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(dyn_par[4]*hx[11,0] - dyn_par[5]*hx[10,0]) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(-dyn_par[0]*hx[10,0] - dyn_par[3]*hx[11,0] - 2*dyn_par[4]*hx[12,0] + dyn_par[2]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + 2*dyn_par[5]*hx[12,0] - dyn_par[2]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[0,0,0,0,0,0,0,0,0,0,(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(dyn_par[0]*hx[11,0] - 2*dyn_par[3]*hx[10,0] - dyn_par[1]*hx[11,0] - dyn_par[5]*hx[12,0]) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(-dyn_par[0]*hx[12,0] + 2*dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[3]*hx[12,0] - dyn_par[4]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(dyn_par[0]*hx[10,0] + 2*dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0] - dyn_par[1]*hx[10,0]) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(-dyn_par[3]*hx[12,0] + dyn_par[5]*hx[10,0]) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(-dyn_par[4]*hx[10,0] + dyn_par[1]*hx[12,0] - 2*dyn_par[5]*hx[11,0] - dyn_par[2]*hx[12,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(dyn_par[4]*hx[11,0] - dyn_par[5]*hx[10,0]) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(-dyn_par[0]*hx[10,0] - dyn_par[3]*hx[11,0] - 2*dyn_par[4]*hx[12,0] + dyn_par[2]*hx[10,0]) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + 2*dyn_par[5]*hx[12,0] - dyn_par[2]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])]])

def B_no_discrete_no_scaled_SCVx(hx, hu, dyn_par):
    return np.array([[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[1,0,0,0,0,0],[0,1,0,0,0,0],[0,0,1,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,(-dyn_par[1]*dyn_par[2] + dyn_par[5]**2)/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-dyn_par[3]*dyn_par[5] + dyn_par[4]*dyn_par[1])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[0,0,0,(dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-dyn_par[0]*dyn_par[2] + dyn_par[4]**2)/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[0,0,0,(-dyn_par[3]*dyn_par[5] + dyn_par[4]*dyn_par[1])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]),(-dyn_par[0]*dyn_par[1] + dyn_par[3]**2)/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])]])

def y_no_discrete_no_scaled_SCVx(hx, hu, dyn_par):
    return np.array([[0],[0],[0],[0],[0],[0],[0.5*hx[7,0]*hx[10,0] + 0.5*hx[8,0]*hx[11,0] + 0.5*hx[9,0]*hx[12,0]],[-0.5*hx[6,0]*hx[10,0] - 0.5*hx[8,0]*hx[12,0] + 0.5*hx[9,0]*hx[11,0]],[-0.5*hx[6,0]*hx[11,0] + 0.5*hx[7,0]*hx[12,0] - 0.5*hx[9,0]*hx[10,0]],[-0.5*hx[6,0]*hx[12,0] - 0.5*hx[7,0]*hx[11,0] + 0.5*hx[8,0]*hx[10,0]],[-hu[3,0]*(-dyn_par[1]*dyn_par[2] + dyn_par[5]**2)/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hu[4,0]*(dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hu[5,0]*(-dyn_par[3]*dyn_par[5] + dyn_par[4]*dyn_par[1])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[10,0]*(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[0]*hx[11,0] - 2*dyn_par[3]*hx[10,0] - dyn_par[1]*hx[11,0] - dyn_par[5]*hx[12,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[0]*hx[12,0] + 2*dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - (dyn_par[3]*hx[12,0] - dyn_par[4]*hx[11,0])*(dyn_par[1]*dyn_par[2] - dyn_par[5]**2))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[11,0]*(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[0]*hx[10,0] + 2*dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0] - dyn_par[1]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[3]*hx[12,0] + dyn_par[5]*hx[10,0]) - (dyn_par[1]*dyn_par[2] - dyn_par[5]**2)*(-dyn_par[4]*hx[10,0] + dyn_par[1]*hx[12,0] - 2*dyn_par[5]*hx[11,0] - dyn_par[2]*hx[12,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[12,0]*(-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[4]*hx[11,0] - dyn_par[5]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[0]*hx[10,0] - dyn_par[3]*hx[11,0] - 2*dyn_par[4]*hx[12,0] + dyn_par[2]*hx[10,0]) - (dyn_par[1]*dyn_par[2] - dyn_par[5]**2)*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + 2*dyn_par[5]*hx[12,0] - dyn_par[2]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) + (-(dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(hu[5,0] - hx[10,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0]) + hx[11,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(hu[4,0] + hx[10,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - hx[12,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) - (dyn_par[1]*dyn_par[2] - dyn_par[5]**2)*(hu[3,0] - hx[11,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + hx[12,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0])))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[-hu[3,0]*(dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hu[4,0]*(-dyn_par[0]*dyn_par[2] + dyn_par[4]**2)/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hu[5,0]*(dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[10,0]*((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(dyn_par[0]*hx[11,0] - 2*dyn_par[3]*hx[10,0] - dyn_par[1]*hx[11,0] - dyn_par[5]*hx[12,0]) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(-dyn_par[0]*hx[12,0] + 2*dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(dyn_par[3]*hx[12,0] - dyn_par[4]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[11,0]*((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(dyn_par[0]*hx[10,0] + 2*dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0] - dyn_par[1]*hx[10,0]) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(-dyn_par[3]*hx[12,0] + dyn_par[5]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(-dyn_par[4]*hx[10,0] + dyn_par[1]*hx[12,0] - 2*dyn_par[5]*hx[11,0] - dyn_par[2]*hx[12,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[12,0]*((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(dyn_par[4]*hx[11,0] - dyn_par[5]*hx[10,0]) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(-dyn_par[0]*hx[10,0] - dyn_par[3]*hx[11,0] - 2*dyn_par[4]*hx[12,0] + dyn_par[2]*hx[10,0]) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + 2*dyn_par[5]*hx[12,0] - dyn_par[2]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) + ((dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(hu[5,0] - hx[10,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0]) + hx[11,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) - (dyn_par[0]*dyn_par[2] - dyn_par[4]**2)*(hu[4,0] + hx[10,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - hx[12,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) + (dyn_par[3]*dyn_par[2] - dyn_par[4]*dyn_par[5])*(hu[3,0] - hx[11,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + hx[12,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0])))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])],[-hu[3,0]*(-dyn_par[3]*dyn_par[5] + dyn_par[4]*dyn_par[1])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hu[4,0]*(dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hu[5,0]*(-dyn_par[0]*dyn_par[1] + dyn_par[3]**2)/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[10,0]*(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(dyn_par[0]*hx[11,0] - 2*dyn_par[3]*hx[10,0] - dyn_par[1]*hx[11,0] - dyn_par[5]*hx[12,0]) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(-dyn_par[0]*hx[12,0] + 2*dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[3]*hx[12,0] - dyn_par[4]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[11,0]*(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(dyn_par[0]*hx[10,0] + 2*dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0] - dyn_par[1]*hx[10,0]) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(-dyn_par[3]*hx[12,0] + dyn_par[5]*hx[10,0]) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(-dyn_par[4]*hx[10,0] + dyn_par[1]*hx[12,0] - 2*dyn_par[5]*hx[11,0] - dyn_par[2]*hx[12,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) - hx[12,0]*(-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(dyn_par[4]*hx[11,0] - dyn_par[5]*hx[10,0]) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(-dyn_par[0]*hx[10,0] - dyn_par[3]*hx[11,0] - 2*dyn_par[4]*hx[12,0] + dyn_par[2]*hx[10,0]) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + 2*dyn_par[5]*hx[12,0] - dyn_par[2]*hx[11,0]))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1]) + (-(dyn_par[0]*dyn_par[1] - dyn_par[3]**2)*(hu[5,0] - hx[10,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0]) + hx[11,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) + (dyn_par[0]*dyn_par[5] - dyn_par[3]*dyn_par[4])*(hu[4,0] + hx[10,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) - hx[12,0]*(dyn_par[0]*hx[10,0] + dyn_par[3]*hx[11,0] + dyn_par[4]*hx[12,0])) - (dyn_par[3]*dyn_par[5] - dyn_par[4]*dyn_par[1])*(hu[3,0] - hx[11,0]*(dyn_par[4]*hx[10,0] + dyn_par[5]*hx[11,0] + dyn_par[2]*hx[12,0]) + hx[12,0]*(dyn_par[3]*hx[10,0] + dyn_par[1]*hx[11,0] + dyn_par[5]*hx[12,0])))/(-dyn_par[0]*dyn_par[1]*dyn_par[2] + dyn_par[0]*dyn_par[5]**2 + dyn_par[3]**2*dyn_par[2] - 2*dyn_par[3]*dyn_par[4]*dyn_par[5] + dyn_par[4]**2*dyn_par[1])]])

def C_no_discrete_no_scaled_SCVx(hx, hu, dyn_par):
    return np.array([[-(-dyn_par[6] + hx[0,0])/math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2),-(-dyn_par[7] + hx[1,0])/math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2),-(-dyn_par[8] + hx[2,0])/math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2),0,0,0,0,0,0,0,0,0,0],[-(-dyn_par[9] + hx[0,0])/math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2),-(-dyn_par[10] + hx[1,0])/math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2),-(-dyn_par[11] + hx[2,0])/math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2),0,0,0,0,0,0,0,0,0,0],[-(-dyn_par[12] + hx[0,0])/math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2),-(-dyn_par[13] + hx[1,0])/math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2),-(-dyn_par[14] + hx[2,0])/math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2),0,0,0,0,0,0,0,0,0,0]])

def D_no_discrete_no_scaled_SCVx(hx, hu, dyn_par):
    return np.array([[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]])

def z_no_discrete_no_scaled_SCVx(hx, hu, dyn_par):
    return np.array([[dyn_par[15] + hx[0,0]*(-dyn_par[6] + hx[0,0])/math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2) + hx[1,0]*(-dyn_par[7] + hx[1,0])/math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2) + hx[2,0]*(-dyn_par[8] + hx[2,0])/math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2) - math.sqrt((-dyn_par[6] + hx[0,0])**2 + (-dyn_par[7] + hx[1,0])**2 + (-dyn_par[8] + hx[2,0])**2)],[dyn_par[16] + hx[0,0]*(-dyn_par[9] + hx[0,0])/math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2) + hx[1,0]*(-dyn_par[10] + hx[1,0])/math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2) + hx[2,0]*(-dyn_par[11] + hx[2,0])/math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2) - math.sqrt((-dyn_par[9] + hx[0,0])**2 + (-dyn_par[10] + hx[1,0])**2 + (-dyn_par[11] + hx[2,0])**2)],[dyn_par[17] + hx[0,0]*(-dyn_par[12] + hx[0,0])/math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2) + hx[1,0]*(-dyn_par[13] + hx[1,0])/math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2) + hx[2,0]*(-dyn_par[14] + hx[2,0])/math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2) - math.sqrt((-dyn_par[12] + hx[0,0])**2 + (-dyn_par[13] + hx[1,0])**2 + (-dyn_par[14] + hx[2,0])**2)]])
